#+OPTIONS: toc:nil
# #+LaTeX_CLASS: koma-article 

#+LATEX_CLASS: beamer
#+LATEX_CLASS_OPTIONS: [presentation,aspectratio=169]
#+OPTIONS: H:2

#+LaTex_HEADER: \usepackage{khpreamble}
#+LaTex_HEADER: \usepackage{amssymb}
#+LaTex_HEADER: \usepgfplotslibrary{groupplots}

#+LaTex_HEADER: \newcommand*{\shift}{\operatorname{q}}
#+LaTex_HEADER: \DeclareMathSymbol{\Omega}{\mathalpha}{letters}{"0A}% italics
#+LaTex_HEADER: \DeclareMathSymbol{\varOmega}{\mathalpha}{operators}{"0A}% upright
#+LaTex_HEADER: \providecommand*{\upOmega}{\varOmega}% for siunitx
#+LaTex_HEADER: \usepackage[binary-units=true]{siunitx}
#+LaTex_HEADER: \usepackage{circuitikz}

#+title: Actuators
#+author: Kjartan Halvorsen
# #+date: 2021-03-01

* What do I want the students to understand?			   :noexport:
  - How to find power and torque requirements
  - Basic working of an electric motor
  - Equivalent circuit
    
* Which activities will the students do?			   :noexport:

* Mechanical requirements

** Mechanical requirements
** Mechanical energy
   From Encyclopaedia Britannica
   #+begin_quote
*Mechanical energy* The sum of kinetic energy (the energy in movement) and the potential energy (energy stored in a system due to the position of its parts).
   #+end_quote

   \[ E_M = \underbrace{K}_{\text{Kinetic energy}} + \underbrace{U}_{\text{Potential energy}}\]

   #+BEAMER: \pause
   A point mass $m$ with velocity $v$ at a height $h$ above the reference level, has mechanical energy \(E_M = \frac{1}{2}mv^2 + mgh\).

   \begin{center}
   \includegraphics[height=0.3\textheight]{../../figures/pendulum.png}
   {\footnotesize Source: Hubert Christiaen, wikipedia}
   \end{center}
   

** Work
   From Encyclopaedia Britannica
   #+begin_quote
   *Work* In physics, the measure of *transfer of energy* when an object is diplaced *a certain distance* by an *external force* which has a component in the direction of the displacement..
   #+end_quote 

** Work
   \begin{center}
   \includegraphics[height=0.6\textheight]{../../figures/pulley-block-50kg.png}
   \end{center}

   *Activity* A mass of \unit{50}{\kilogram} is lifted a distance of \unit{10}{\meter}. What is the work done?
   
*** Result                                                         :noexport:
#+BEGIN_SRC python :session :results output 
  M = 50
  h = 10
  print("Work required to lift mass m = %0.1fkg to a height of h = %0.1fm is W = mgh = %0.1f Joule" %(M, h, M*9.8*h))
#+END_SRC

#+RESULTS:
: Work required to lift mass m = 50.0kg to a height of h = 10.0m is W = mgh = 4900.0 Joule



** Power
   *Definition* The time-derivative of work.

** Power
   \begin{center}
   \includegraphics[height=0.6\textheight]{../../figures/pulley-block-50kg.png}
   \end{center}

   *Activity* A mass of \unit{50}{\kilogram} is lifted a distance of \unit{10}{\meter} in 5 seocnds. What is the average power required?
   
*** Result                                                         :noexport:
#+BEGIN_SRC python :session :results output 
  M = 50
  h = 10
  v = 2
  print("Power required to lift mass m = %0.1fkg at constant vel v = %0.1fm/s is P = mgv = %0.1f W" %(M, v, M*9.8*v))
#+END_SRC

#+RESULTS:
: Power required to lift mass m = 50.0kg at constant vel v = 2.0m/s is P = mgv = 980.0 W

** Power and acceleration

   #+begin_export latex
   \begin{center}
\begin{tikzpicture}

  \begin{scope}[scale=0.3, xshift=4cm]
  \node[anchor=south,] {\includegraphics[width=3cm]{../../figures/hummer-ev.png}};
    \draw[thin, ] (-8,2) -- (-6,2);
    \draw[thin, ] (-9,3) -- (-6.5,3);
  \end{scope}

  \draw[->,semithick] (-.5,0.16) -- (8,0.16);
\end{tikzpicture}
\end{center}

   #+end_export

   
   *Activity* The new Hummer EV has a mass of $m=\unit{5000}{\kilogram}$, and can accelerate from \unit{0 - 100}{\kilo\meter\per\hour} in three seconds. What is the average power required to achieve this (ignoring wind- and rolling resistance)?

   
*** Result                                                         :noexport:
#+BEGIN_SRC python :session :results output 
  M = 5000
  v = 100*1000.0/3600
  t = 3
  P= 0.5*M*v**2/t
  print("Power needed to accelerate m = %0.1fkg to vel v = %0.1fm/s in %0.1s is P = 0.5*m*v^2/t = %0.1f W = %0.2f kW" %(M, v, t, P, P/1000.0 ))
#+END_SRC

#+RESULTS:
: Power needed to accelerate m = 5000.0kg to vel v = 27.8m/s in 3 is P = 0.5*m*v^2/t = 643004.1 W = 643.00 kW

** Power in rotating systems

   *Torque* multiplied with *angular velocity*

   \[ P = T\omega\]

** Skip                                                            :noexport:
   #+begin_export latex
   \begin{center}
     \begin{tikzpicture}

     \begin{scope}[scale=1, xshift=2cm, yshift=2cm]
       \node[] {\includegraphics[width=2cm]{../../figures/mech-rotor}};
       \node[green!80!black] at (2.6,0) {Driving forward};
       \end{scope}

     \begin{scope}[scale=1, xshift=-2cm, yshift=2cm]
       \node[] {\includegraphics[width=2cm]{../../figures/mech-motor-back-break}};
       \node[red!80!black, anchor=east] at (-2,0) {Braking};
     \end{scope}

     \begin{scope}[scale=1, xshift=-2cm, yshift=-2cm]
       \node[] {\includegraphics[width=2cm]{../../figures/mech-motor-back}};
       \node[green!80!black, anchor=east] at (-2,0) {Driving backward};
     \end{scope}

     \begin{scope}[scale=1, xshift=2cm, yshift=-2cm]
       \node[] {\includegraphics[width=2cm]{../../figures/mech-rotor-break}};
       \node[red!80!black] at (2.6,0) {Braking};
     \end{scope}

     \draw[->,semithick] (-3, 0) -- (3, 0) node[right] {$\omega$};
     \draw[->,semithick] (0, -3) -- (0, 3) node[above] {$T$};
   \end{tikzpicture}
   \end{center}

   #+end_export
   
   

** Moment of inertia

*** Graphics
    :PROPERTIES:
    :BEAMER_col: 0.38
    :END:
   #+begin_export latex
   \begin{center}
   \includegraphics[height=0.6\textheight]{../../figures/moment-of-inertia-cylinder.png}
   {\footnotesize Source: Georgia State University}
   \end{center}
   #+end_export

*** Text
    :PROPERTIES:
    :BEAMER_col: 0.72
    :END:

   Moment of inertia is a parameter in Newton's law that determines

- the tendency of a body to resist angular acceleration:
   \[ \textcolor{red!80!black}{J} \dot{\omega} = \sum T_i \]
- the kinetic energy of a body rotating at a certain angular velocity:
   \[ K = \frac{1}{2}\textcolor{red!80!black}{J}\omega^2.\]



** Inercia                                                         :noexport:
   #+begin_export latex
   \begin{center}
   \includegraphics[width=0.6\textwidth]{../../figures/mech-mass-on-band}
   \end{center}
   #+end_export

   Assume pulleys have moment of inertia $J_p$, mass $m$ includes the mass of the band and the box, the rotor  has moment of inertia $J_m$. The belt velocity and the angular velocities are related as \(\omega_mr = \omega_pR = v\).  

   The total kinetic energy is the sum of the kinetic energy in the different moving bodies
   \begin{align*}
   K &= \frac{1}{2}(2J_p)\omega_p^2 + \frac{1}{2}J_m\omega_m^2 + \frac{1}{2}m v^2
    = J_p\big(\frac{r}{R}\omega_m\big)^2 + \frac{1}{2}J_m\omega_m^2 + \frac{1}{2}m(r\omega_m)^2\\
    &= \frac{1}{2}(\underbrace{\textcolor{red!80!black}{J_m + 2(\frac{r}{R})^2J_p + mr^2}}_{\text{Inertia experienced by motor}}) \omega_m^2.
   \end{align*}

   
** Power and torque requirements for an elevator

*** Graphics
    :PROPERTIES:
    :BEAMER_col: 0.38
    :END:
   #+begin_center
   \includegraphics[height=0.8\textheight]{../../figures/mech-elevator}
   #+end_center

*** Text
    :PROPERTIES:
    :BEAMER_col: 0.72
    :END:

    An elevator with mass \(M=\unit{1000}{\kilogram}\), and a counterweight with mass \(m=\unit{800}{\kilogram}\) are connected by a wire which runs over a pulley with radius of \(r=\unit{0.4}{\meter}\). An electric  motor is connected to the pulley via a transmission with gear ratio of 12:1 (12 revolutions of the motor for each revolution of the pulley). The motor has a moment of inertia of \(J_m = \unit{0.3}{\kilogram\meter\squared}\). The inertia of the pulley can be ignored.

    *Activity* 
   *(a)* At what angular velocity is the motor rotating when the elevator is ascending at \unit{4}{\meter\per\second}? *(b)* Determine the power and the motor torque necessary to lift the elevator at \unit{4}{\meter\per\second} (assuming no friction). *(c)* The elevator takes two seconds to reach the velocity \unit{4}{\meter\per\second} from zero. During this time, the elevator has moved up \unit{4}{\meter}. Determine the average power and torque during the start.

*** Solution                                                       :noexport:

#+BEGIN_SRC python :session :results output 
  M = 1000
  m = 800
  v = 4
  r = 0.4
  gr = 1.0/12
  Jm = 0.3
  Jp = 0
  wp = v/r
  wm = 12*v/r
  
  Jpa = Jp*gr**2
  Jea = (m+M)*(r*gr)**2
  Jtot = Jm + Jp*gr**2 + (m+M)*(r*gr)**2
  
  print("(a) Velocidad angular del motor omega_m = %f rad/s = %0.2f rpm" %(wm, wm/(2*np.pi)*60))
  
  
  v = 4
  Pconst = (M-m)*9.8*v
  print("(b) Power required to lift at constant speed, Pconst = %f" %Pconst)
  print("(b) Torque required to lift at constant speed, T = %f" %(Pconst/wm))
  
  U = (M-m)*9.8*4 # Potential energy gained
  K = 0.5*Jm*wm**2 + 0.5*(M+m)*v**2
  Etot = U + K
  t = 2
  Pacc = Etot/t
  print("(c) Energy at end of acceleration, E = U + K = %f + %f = %f" %(U, K, Etot))
  print("    Power required P = E/t = %f W = %0.1f kW" %(Pacc, Pacc/1000.0))
  print("    torque required P = E/t = %f W = %0.1f kW" %(Pacc, Pacc/1000.0))
  print("    K  = %f J " %(K))
#+END_SRC

#+RESULTS:
: (a) Velocidad angular del motor omega_m = 120.000000 rad/s = 1145.92 rpm
: (b) Power required to lift at constant speed, Pconst = 7840.000000
: (b) Torque required to lift at constant speed, T = 65.333333
: (c) Energy at end of acceleration, E = U + K = 7840.000000 + 16560.000000 = 24400.000000
:     Power required P = E/t = 12200.000000 W = 12.2 kW
:     torque required P = E/t = 12200.000000 W = 12.2 kW
:     K  = 16560.000000 J

* The DC motor
** The DC motor
   #+begin_export latex
   \begin{center}
   \includegraphics[height=0.6\textheight]{../../figures/wiki-small-dc-motor.jpg}
   \includegraphics[width=0.6\textheight]{../../figures/Siemens-DC-prop.png}\\
   {\footnotesize Source: Wikipedia \hspace*{3cm} Source: Siemens AG}
   \end{center}
   #+end_export

   
** Force on an electrical conductor in a magnetic field
   #+begin_center
   \includegraphics[width=0.4\linewidth]{../../figures/HD-fig1_14.png}
   \includegraphics[width=0.53\linewidth]{../../figures/HD-fig1_15.png}
   #+end_center

   
*** Source
   #+begin_center
   \includegraphics[width=0.2\linewidth]{../../figures/textbook.png}
   #+end_center
    
   
** Force on an electrical conductor in a magnetic field
   #+begin_center
   \includegraphics[width=0.4\linewidth]{../../figures/HD-fig1_14.png}
   \includegraphics[width=0.53\linewidth]{../../figures/HD-fig1_15.png}
   #+end_center

   The electromagnetic force  in a conductor is *proportional to the current* and *the strength of the magnetic field*:
   \[F=k_mI=(Bl_m)I,\] where $B$ is the magnetic flux density in the gap, $I$ is the current, an $l_m$ is the length of the conductor. 

   *Activity* In a large motor of \unit{4}{\mega\watt} with an axial length of \(l_m=\unit{2}{\meter}\), the magnetic flux density is \(B=\unit{0.8}{\tesla}\) and the current is \(I=\unit{3}{\kilo\ampere}\). How many parallel conductors are needed to achieve a force of \(F=\unit{259.2}{\kilo\newton}\)?

*** Solution                                                       :noexport:

#+BEGIN_SRC python :session :results output 
  B = 0.8
  l = 2
  I = 3e3
  Torq = 190e3
  r = 750e-3
  F = Torq/r

  # F = NBIl =>
  N = F/(B*I*l)
  print("Number of cables in parallel N = %0.2f" %(N))

  N = 54
  F = N*B*I*l
  print("Force with 54 cables in parallel F = %0.2f kN" %(F/1000.0))
  #+END_SRC

#+RESULTS:
: Number of cables in parallel N = 52.78
: Force with 54 cables in parallel F = 259.20 kN
   
** The two equations of the DC motor

*** The force on the electrical conductor in the magnetic field
   \[ F(t) = k_m i(t) \quad\Leftrightarrow\quad T(t) = k_m r i(t),\]
   where $r$ is the radius of the motor.

*** Voltage generated in a conductor that moves in a magnetic field
   \[ e(t) = k_v v(t) \quad\Leftrightarrow\quad e(t) = k_v r \omega(t)\]
   \(e(t)\) is called  /Back electro-motive force (Back e.m.f.)/.

** Electrical and mechanical power
   #+begin_center
   \includegraphics[width=0.4\linewidth]{../../figures/HD-fig1_14.png}
   \includegraphics[width=0.53\linewidth]{../../figures/HD-fig1_15.png}
   #+end_center

   With constant velocity $v$ and ignoring friction and electrical resistance: 

   \[ \text{Electromagnetic force} = \text{Mechanical force} \quad\Leftrightarrow\quad F=k_mI =Bl_mI = mg\]
   \[ \text{Electric power} = \text{Mechanical power} \quad \Leftrightarrow\quad \underbrace{V_1I}_{P_e} = \underbrace{Fv = Bl_mI v}_{P_m} \] 
   It is necessary to apply a voltaje $V_1$ across the cable to maintain the current $I$. *This voltage is equal to the back e.m.f.* 
   \[ V_1I = Bl_mIv \quad \Rightarrow \quad V_1 = (Bl_m)v = k_v v = \tikz[baseline = 0.1ex]{\node[red, circle, draw, inner sep=3pt, pin={[red]0:{Back e.m.f.}}] at (0, 0.1 cm) {\textcolor{black}{E}}}\]

   *Actividad* What is the relationship between the two constants $k_v$ and $k_m$?

** Electrical and mechanical power

   In practice some energy is lost due to the resistance in the electrical circuit.
   \begin{align*}
   \text{Electrical power drawn} &= \text{Heat production} + \text{Mechanical power}\\
   V_2 I &= RI^2 + EI
   \end{align*}
   Where \(V_2 > V_1 = (Bl_m)v = E\).

   The efficiency of the motor

   \[ \text{efficiency} = \frac{\text{Mechanical power}}{\text{Electrical power drawn}} = \frac{EI}{V_2I} = \frac{E}{RI + E}\]
   
   *Activity* An electri motor has a motor constant \(k=\unit{0.05}{\kilo\newton\per\ampere}\) and an armature resistance  of \(R=\SI{2}{\milli\ohm}\). It is producing a mechanical power of \unit{4}{\mega\watt} at a velocity of \(v=\unit{10}{\meter\per\second}\). Calculate the back e.m.f \(E\), the current \(I\), then voltage \(V_2\) and the efficiency.

*** Solution                                                       :noexport:

#+BEGIN_SRC python :session :results output 
  import numpy as np
  P = 4e6
  k = 0.05e3
  v = 10
  r = 750e-3
  Inom = 3.5e3
  copper_loss = 28e3
  R = copper_loss/Inom**2

  print("Armature resistance R = %0.2f mOhm " %(R*1000))
  print("Velocity = %0.2f m/s => Ang vel = %0.2f rpm " %(v, v/r/2/np.pi*60))

  R = 2e-3
  E = k*v
  I = P/E
  V2 = R*I + E
  print("Back emf E = %0.2f V" %(E))
  print("Current I = %0.2f kA" %(I/1000))
  print("Voltage drop in windings IR = %0.2f V" %(I*R))
  print("Voltage supplied V2 = %0.2f V" %(V2))
  print("Energy drop in windings I^2R = %0.2f kW" %(I**2*R/1000))
  print("Efficiency  = %0.2f = %0.2f" %(P/(V2*I), E/(E+R*I)))

  #+END_SRC

#+RESULTS:
: Armature resistance R = 2.29 mOhm 
: Velocity = 10.00 m/s => Ang vel = 127.32 rpm 
: Back emf E = 500.00 V
: Current I = 8.00 kA
: Voltage drop in windings IR = 16.00 V
: Voltage supplied V2 = 516.00 V
: Energy drop in windings I^2R = 128.00 kW
: Efficiency  = 0.97 = 0.97
   
** Potencia eléctrica y mecánica                                   :noexport:
*** Equilibrio de energía   
   \begin{align*}
   \text{Potencia eléctrica aplicada} &= \text{Producción de calor} + \text{Potencia mecánica}\\
   V_2 I &= RI^2 + EI
   \end{align*}
*** Eficiencia
   \[ \text{eficiencia} = \frac{\text{Potencia mecánica}}{\text{Potencia eléctrica aplicada}} = \frac{V_2}{RI + E}\]
   
   *Actividad en pares* En el ejemplo anterior el motor tenía un constante de \(k=\unit{0.05}{\kilo\newton\per\ampere}\). Supone que otro motor con la misma resistancia \(R=\SI{2}{\milli\ohm}\) está haciendo el mismo trabajo (\unit{4}{\mega\watt} a \unit{10}{\meter\per\second}), pero tiene el konstante $k=\unit{0.1}{\kilo\newton\per\ampere}$. ¿Cuál es su eficiencia?

*** Solution                                                       :noexport:

#+BEGIN_SRC python :session :results output 
  import numpy as np
  P = 4e6
  v = 10
  k = 0.1e3
  R = 2e-3

  E = k*v
  I = P/E
  V2 = R*I + E
  print("Current I = %0.2f kA" %(I/1000))
  print("Back emf E = %0.2f V" %(E))
  print("Current I = %0.2f kA" %(I/1000))
  print("Voltage drop in windings IR = %0.2f V" %(I*R))
  print("Voltage supplied V2 = %0.2f V" %(V2))
  print("Energy drop in windings I^2R = %0.2f kW" %(I**2*R/1000))
  print("Efficiency  = %0.2f = %0.2f" %(P/(V2*I), E/(E+R*I)))

  #+END_SRC

#+RESULTS:
: Current I = 4.00 kA
: Back emf E = 1000.00 V
: Current I = 4.00 kA
: Voltage drop in windings IR = 8.00 V
: Voltage supplied V2 = 1008.00 V
: Energy drop in windings I^2R = 32.00 kW
: Efficiency  = 0.99 = 0.99
   

** Potencia eléctrica y mecánica                                   :noexport:
*** Equilibrio de energía   
   \begin{align*}
   \text{Potencia eléctrica aplicada} &= \text{Producción de calor} + \text{Potencia mecánica}\\
   V_2 I &= RI^2 + EI
   \end{align*}
*** Eficiencia
   \[ \text{eficiencia} = \frac{\text{Potencia mecánica}}{\text{Potencia eléctrica aplicada}} = \frac{V_2}{RI + E}\]
   
   *Actividad individual* Supone que el motor con constante de \(k=\unit{0.05}{\kilo\newton\per\ampere}\) está produciendo la mismo potencia que antes (\unit{4}{\mega\watt}) pero por medio de una transmissión lo haga a la velocidad \unit{20}{\meter\per\second}). ¿Cuál es su eficiencia?

*** Solution                                                       :noexport:

#+BEGIN_SRC python :session :results output 
  import numpy as np
  P = 4e6
  v = 20
  k = 0.05e3
  R = 2e-3

  E = k*v
  I = P/E
  V2 = R*I + E
  print("Current I = %0.2f kA" %(I/1000))
  print("Back emf E = %0.2f V" %(E))
  print("Current I = %0.2f kA" %(I/1000))
  print("Voltage drop in windings IR = %0.2f V" %(I*R))
  print("Voltage supplied V2 = %0.2f V" %(V2))
  print("Energy drop in windings I^2R = %0.2f kW" %(I**2*R/1000))
  print("Efficiency  = %0.2f = %0.2f" %(P/(V2*I), E/(E+R*I)))

  #+END_SRC

#+RESULTS:
: Current I = 4.00 kA
: Back emf E = 1000.00 V
: Current I = 4.00 kA
: Voltage drop in windings IR = 8.00 V
: Voltage supplied V2 = 1008.00 V
: Energy drop in windings I^2R = 32.00 kW
: Efficiency  = 0.99 = 0.99
   

** Rotation
   #+begin_export latex
   \begin{center}
   \includegraphics[width=0.4\linewidth]{../../figures/HD-fig3_1.png}
   \includegraphics[width=0.53\linewidth]{../../figures/HD-fig3_2.png}
   {\footnotesize Source: Hughes and Drury}
   \end{center}
   #+end_export
   
** Equivalent circuit

   #+begin_export latex
      \begin{center}
	\begin{circuitikz}
	  \draw (4,1) node[elmech](motor){M};
	  \draw (motor.north) to[R=$R$] (4,4) to[L=$L$] (0,4)
	  to[american voltage source, label=$V$] (0,0) -| (motor.south);
	  \draw[thick,->>](motor.right)--++(1,0)node[midway,above]{$\omega$};

	  \node[] at (2, -0.8 cm) {\(L \frac{d}{dt}i(t) +  Ri(t) + k\omega(t) = V\)};

	  \begin{scope}[xshift=8cm]
	  \draw (4,1) node[elmech](motor){M};
	  \draw (motor.north) to[R=$R$] (4,4) to[short] (0,4)
	  to[american voltage source, label=$V$] (0,0) -| (motor.south);
	  \draw[thick,->>](motor.right)--++(1,0)node[midway,above]{$\omega$};
	  \node[] at (2, -0.8 cm) {\(Ri(t) + k\omega(t) = V\)};
	  \end{scope}
	\end{circuitikz}
      \end{center}
   #+end_export

   #+begin_center
   Newton: \( J\frac{d}{dt}\omega(t) = ki(t) - T_l(t)\)
   #+end_center


** Velocity with constant load

   \begin{align}
   L\frac{d}{dt}i(t) + Ri(t) + k\omega(t) &= V(t)\\
   J\frac{d}{dt}\omega(t) &= ki(t) - T_l(t)
   \end{align}

   In steady-state: \(i(t) = I\), \(\omega(t) = \omega\).

   \begin{align}
   RI + k\omega &= V\\
   0 &= kI - T_l
   \end{align}

   *Activity* Write the angular velocity as function of the load $T_l$ and the volage $V$
   \[\omega = f(V, T_l) = \frac{V}{k} - \frac{RT_l}{k^2}\]

** Velocity with constant load

   \[\omega = f(V, T_l) = \frac{V}{k} - \frac{RT_l}{k^2}\]
   A specific motor has a motor constant \(k=\unit{4}{\newton\meter\per\ampere}\) and armature resistence \(R=\SI{1}{\ohm}\). A voltage of \(V=\unit{100}{\volt}\) is applied over the armature circuit.


   *Activity* Sketch how the steady-state velocity depends on the load $T_l$. What is the stall torque (the torque that will cause the motor to stand still)?

       #+begin_export latex
	\begin{center}
	  \begin{tikzpicture}[xscale=0.8]
	    \draw[->] (0, 0) -- (9, 0) node[right] {$T_l$ [\unit{}{\newton\meter}]};
	    \draw[->] (0, 0) -- (0, 3) node[left] {$\omega$};
	    \foreach \t in { 1, 2, ..., 8} {
	    \draw (\t, 0) -- (\t, -0.1) node[below] {\t{}00};
	    }
	    \end{tikzpicture}

	\end{center}
    #+end_export


   
*** Result                                                         :noexport:
  #+BEGIN_SRC python :session  :results output 
    import numpy as np
    V = 100
    R = 1
    Vnom = 500
    Inom = 20
    Pnom = Vnom*Inom
    E = Vnom - Inom*R
    rpm_500 = 1040
    w_500 = rpm_500/60*2*np.pi
    I_500 = 0.8
    E_500 = 500 - R*I_500
    k = E_500/w_500

    # R*Tl/k + k*w = V
    Tl = np.array([0, 100, 400, 800])
    w = V/k - R*Tl/k**2
    Tstall = V*k/R
    print(np.vstack((Tl, w)))
    print("Stall torque = %0.2f kNm" %(Tstall/1000))
  #+END_SRC

  #+RESULTS:
  : [[  0.         100.         400.         800.        ]
  :  [ 21.81661565  17.05696847   2.77802691 -16.26056182]]
  : Stall torque = 0.46 kNm
   
** Start-up

   For a motor that is not rotating, the back e.m.f is zero, and only the resistance and the inductance of the armature limits the current.

      #+begin_export latex
      \begin{center}
	\begin{circuitikz}
	  \draw (4,1) node[elmech](motor){M};
	  \draw (motor.north) to[R=$R$] (4,4) to[L=$L$] (0,4)
	  to[american voltage source, label=$V$] (0,0) -| (motor.south);
	  \draw[thick,->>](motor.right)--++(1,0)node[midway,above]{$\omega$};

	  \node[] at (2, -0.8 cm) {\(L \frac{d}{dt}i(t) +  Ri(t) + k\omega(t) = V\)};
	\end{circuitikz}
      \end{center}
   #+end_export


      It is necessary to be careful with applying too much voltage at start-up to avoid excessive current in the motor.

* Modeling
** Block-diagram of the equivalent circuit

      #+begin_export latex
      \begin{center}
	\begin{circuitikz}
	  \draw (4,1) node[elmech](motor){M};
	  \draw (motor.north) to[R=$R$] (4,4) to[L=$L$] (0,4)
	  to[american voltage source, label=$V$] (0,0) -| (motor.south);
	  \draw[thick,->>](motor.right)--++(1,0)node[midway,above]{$\omega$};

	  \node[] at (9, 2 cm) {\(L \frac{d}{dt}i(t) +  Ri(t) + k\omega(t) = V\)};
	  \node[] at (9, 1 cm) {\(\frac{d}{dt}i(t) = \frac{1}{L} \Big(-Ri(t) - k\omega(t) + V\Big)\)};
	\begin{scope}[yshift=-15mm, xshift=8cm,
	block/.style={rectangle, draw, minimum width=12mm, minimum height=10mm},
	amp/.style = {regular polygon, regular polygon sides=3,
              draw, fill=white, text width=1em,
              inner sep=1pt, outer sep=0mm,
              shape border rotate=-90},
	      summ/.style = {circle, draw, inner sep = 1pt},]
	 \node[block,] (int) at (0,0) {$\int$};
	 \node[amp, left of=int, node distance=30mm] (oneoverL) {$\frac{1}{L}$}; 
	 \draw[->] (oneoverL) -- node[above] {$\frac{d}{dt}i(t)$} (int);
	 \node[summ, left of=oneoverL, node distance=20mm] (sum) {\small $\Sigma$};
	 \node[coordinate, left of=sum, node distance=30mm] (Vin) {};
	 \draw[->] (Vin) -- node[above, near start] {$V$} node[coordinate, pos=0.6] (mp) {} (sum);
	 \node[amp, above of=mp, node distance=15mm] (mkonst) {$-k$};
	 \end{scope}
	\end{circuitikz}
	\end{center}
   #+end_export

   

      
